Version 4
SHEET 1 1280 1076
WIRE 128 80 -704 80
WIRE 256 80 224 80
WIRE 288 80 256 80
WIRE 320 80 288 80
WIRE 448 80 400 80
WIRE 576 80 448 80
WIRE -704 128 -704 80
WIRE 448 128 448 80
WIRE 576 128 576 80
WIRE 208 144 208 128
WIRE 208 240 208 224
WIRE 208 240 -16 240
WIRE -16 272 -16 240
WIRE 256 352 256 80
WIRE 256 352 -16 352
WIRE 288 352 288 80
WIRE 64 432 -48 432
WIRE 240 432 144 432
WIRE -704 560 -704 208
WIRE -48 560 -48 512
WIRE -48 560 -704 560
WIRE 288 560 288 448
WIRE 288 560 -48 560
WIRE 448 560 448 192
WIRE 448 560 288 560
WIRE 576 560 576 208
WIRE 576 560 448 560
WIRE 288 608 288 560
WIRE -448 640 -464 640
WIRE -336 640 -384 640
WIRE 0 656 -16 656
WIRE 112 656 80 656
WIRE -64 688 -112 688
WIRE 112 688 112 656
WIRE -112 704 -112 688
WIRE 176 704 144 704
WIRE 528 704 256 704
WIRE -16 720 -16 656
WIRE 144 720 144 704
WIRE 144 720 -16 720
WIRE -752 752 -752 720
WIRE -384 752 -384 704
WIRE -64 752 -64 688
WIRE 320 752 112 752
WIRE -336 768 -336 640
WIRE -336 768 -352 768
WIRE -304 768 -336 768
WIRE -176 768 -224 768
WIRE -16 768 -16 720
WIRE -16 768 -32 768
WIRE 0 768 -16 768
WIRE 112 768 112 752
WIRE 112 768 80 768
WIRE 528 768 528 704
WIRE 640 768 640 720
WIRE -848 784 -1008 784
WIRE -576 784 -720 784
WIRE -464 784 -464 640
WIRE -464 784 -576 784
WIRE -416 784 -464 784
WIRE -176 784 -176 768
WIRE -128 784 -176 784
WIRE -96 784 -128 784
WIRE -288 800 -352 800
WIRE -16 800 -32 800
WIRE 0 800 -16 800
WIRE 176 800 80 800
WIRE 320 800 320 752
WIRE -640 832 -720 832
WIRE -288 832 -288 800
WIRE -384 848 -384 816
WIRE -64 848 -64 816
WIRE -784 880 -784 864
WIRE -752 880 -752 864
WIRE -752 880 -784 880
WIRE 528 880 528 848
WIRE 640 880 640 848
WIRE -752 896 -752 880
WIRE -640 896 -640 832
WIRE 176 896 176 880
WIRE 256 896 176 896
WIRE 320 896 320 880
WIRE 320 896 256 896
WIRE -176 928 -176 784
WIRE -144 928 -176 928
WIRE -16 928 -16 800
WIRE -16 928 -64 928
WIRE 256 928 256 896
WIRE -288 944 -288 912
WIRE -640 1008 -640 976
FLAG 288 608 0
FLAG 576 80 Vout
FLAG 256 928 0
FLAG 640 880 0
FLAG 640 720 Vcc
FLAG -64 848 Vcc
FLAG -112 704 0
FLAG 112 688 0
FLAG 528 880 0
FLAG -288 944 0
FLAG -384 848 0
FLAG -384 704 Vcc
FLAG -640 1008 0
FLAG -752 720 Vcc
FLAG -752 896 0
FLAG -1008 784 Vpwm
FLAG -576 784 Vcontrol
FLAG -128 784 Verr
SYMBOL voltage -704 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=0.01
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL nmos 128 128 R270
SYMATTR InstName M1
SYMATTR Value BSC032NE2LS
SYMBOL ind 304 96 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 100µ
SYMATTR SpiceLine Rser=0.01
SYMBOL cap 432 128 R0
SYMATTR InstName C1
SYMATTR Value 10µ
SYMATTR SpiceLine V=16 Irms=0 Rser=0 Lser=0
SYMBOL res 560 112 R0
SYMATTR InstName R1
SYMATTR Value 60
SYMATTR SpiceLine tol=10 pwr=10
SYMBOL res 192 128 R0
SYMATTR InstName R2
SYMATTR Value 10
SYMATTR SpiceLine tol=10 pwr=0.25
SYMBOL nmos 240 352 R0
SYMATTR InstName M2
SYMATTR Value BSC032NE2LS
SYMBOL res 160 416 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 10
SYMATTR SpiceLine tol=10 pwr=0.25
SYMBOL bv 320 784 R0
SYMATTR InstName B1
SYMATTR Value V=0.6*I(R1)
SYMBOL voltage 176 784 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 12m
SYMBOL OpAmps\\UniversalOpAmp2 -64 784 R180
SYMATTR InstName U1
SYMATTR SpiceLine Ilimit=0 Rail=0 Vos=0
SYMBOL res 96 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 500
SYMBOL res 96 784 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 500
SYMBOL bv -48 416 R0
SYMATTR InstName B2
SYMATTR Value V=5-V(n004,n002)
SYMBOL voltage 640 752 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL res -16 672 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R6
SYMATTR Value 5k
SYMBOL res -160 944 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R7
SYMATTR Value 5k
SYMBOL voltage 528 752 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 2.5
SYMBOL res 272 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 5k
SYMBOL OpAmps\\UniversalOpAmp2 -384 784 M0
SYMATTR InstName U2
SYMBOL voltage -288 816 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 2.5
SYMBOL res -208 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 100
SYMBOL cap -384 624 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 10µ
SYMBOL voltage -640 880 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR InstName V7
SYMATTR Value PULSE({5/3} {10/3} 0 5u 5u 0 10u)
SYMBOL Comparators\\AD8561 -752 736 M0
SYMATTR InstName U3
SYMBOL bv -16 256 R0
SYMATTR InstName B3
SYMATTR Value V=V(vpwm)
TEXT -696 632 Left 2 !.tran 0.01 startup
